document.addEventListener("DOMContentLoaded", async () => {
    const photographersList = document.getElementById("photographers");

    if (!photographersList) {
        console.error("–û—à–∏–±–∫–∞: –Ω–µ –Ω–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä #photographers –≤ index.html");
        return;
    }

    photographersList.innerHTML = "<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤...</p>";

    try {
        const response = await fetch("https://telegram-gallery.onrender.com/api/photographers");
        if (!response.ok) {
            throw new Error(`–û—à–∏–±–∫–∞ HTTP: ${response.status}`);
        }

        const photographers = await response.json();

        if (photographers.length === 0) {
            photographersList.innerHTML = "<p>–§–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>";
        } else {
            photographersList.innerHTML = "";
            photographers.forEach((photographer) => {
                const photographerElement = document.createElement("div");
                photographerElement.classList.add("photographer");

                // üî• –°–æ–∑–¥–∞—ë–º –∑–≤—ë–∑–¥–æ—á–∫–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —á–∏—Å–ª–æ–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥
                const stars = generateStars(photographer.rating);
                const numericRating = `<span class="rating-number">(${photographer.rating.toFixed(1)})</span>`;

                photographerElement.innerHTML = `
                    <div class="photographer-card">
                        <img src="${photographer.avatar}" alt="${photographer.name}" class="avatar">
                        <h2>${photographer.name}</h2>
                        <p>${photographer.bio || "–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"}</p>
                        <div class="rating">${stars} ${numericRating}</div>
                    </div>
                `;

                photographersList.appendChild(photographerElement);
            });
        }
    } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤:", error);
        photographersList.innerHTML = "<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.</p>";
    }
});

// üî• –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–≤—ë–∑–¥–æ—á–µ–∫ —Å –ø–æ–ª–æ–≤–∏–Ω–∫–∞–º–∏
function generateStars(rating) {
    let starsHTML = "";
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

    for (let i = 0; i < fullStars; i++) {
        starsHTML += '<span class="star full"></span>';
    }

    if (hasHalfStar) {
        starsHTML += '<span class="star half"></span>';
    }

    for (let i = 0; i < emptyStars; i++) {
        starsHTML += '<span class="star empty"></span>';
    }

    return starsHTML;
}
